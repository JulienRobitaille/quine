<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>dist/build/Quine/SDL.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LINE 1 "src/Quine/SDL.hsc" #-}</span>
<a name="line-2"></a><span class='hs-comment'>{-# LANGUAGE CPP #-}</span>
<a name="line-3"></a><span class='hs-comment'>{-# LINE 2 "src/Quine/SDL.hsc" #-}</span>
<a name="line-4"></a><span class='hs-comment'>{-# LANGUAGE DeriveDataTypeable #-}</span>
<a name="line-5"></a><span class='hs-comment'>{-# LANGUAGE ScopedTypeVariables #-}</span>
<a name="line-6"></a><span class='hs-comment'>--------------------------------------------------------------------</span>
<a name="line-7"></a><span class='hs-comment'>-- |</span>
<a name="line-8"></a><span class='hs-comment'>-- Copyright :  (c) 2014 Edward Kmett</span>
<a name="line-9"></a><span class='hs-comment'>-- License   :  BSD2</span>
<a name="line-10"></a><span class='hs-comment'>-- Maintainer:  Edward Kmett &lt;ekmett@gmail.com&gt;</span>
<a name="line-11"></a><span class='hs-comment'>-- Stability :  experimental</span>
<a name="line-12"></a><span class='hs-comment'>-- Portability: non-portable</span>
<a name="line-13"></a><span class='hs-comment'>--</span>
<a name="line-14"></a><span class='hs-comment'>-- Prettier SDL bindings</span>
<a name="line-15"></a><span class='hs-comment'>--------------------------------------------------------------------</span>
<a name="line-16"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Quine</span><span class='hs-varop'>.</span><span class='hs-conid'>SDL</span>
<a name="line-17"></a>  <span class='hs-layout'>(</span> 
<a name="line-18"></a>  <span class='hs-comment'>-- * Versioning</span>
<a name="line-19"></a>    <span class='hs-varid'>version</span>
<a name="line-20"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>revision</span>
<a name="line-21"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>revisionNumber</span>
<a name="line-22"></a>  <span class='hs-comment'>-- * Attribute StateVars</span>
<a name="line-23"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>contextMajorVersion</span>
<a name="line-24"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>contextMinorVersion</span>
<a name="line-25"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>contextFlags</span>
<a name="line-26"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>contextProfileMask</span>
<a name="line-27"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>redSize</span>
<a name="line-28"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>greenSize</span>
<a name="line-29"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>blueSize</span>
<a name="line-30"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>alphaSize</span>
<a name="line-31"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>bufferSize</span>
<a name="line-32"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>depthSize</span>
<a name="line-33"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>stencilSize</span>
<a name="line-34"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>accumRedSize</span>
<a name="line-35"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>accumGreenSize</span>
<a name="line-36"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>accumBlueSize</span>
<a name="line-37"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>accumAlphaSize</span>
<a name="line-38"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>multiSampleBuffers</span>
<a name="line-39"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>multiSampleSamples</span>
<a name="line-40"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>stereo</span>
<a name="line-41"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>acceleratedVisual</span>
<a name="line-42"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>doubleBuffer</span>
<a name="line-43"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>shareWithCurrentContext</span>
<a name="line-44"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>framebufferSRGBCapable</span>
<a name="line-45"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>swapInterval</span>
<a name="line-46"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>windowDisplayMode</span>
<a name="line-47"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>desktopDisplayMode</span>
<a name="line-48"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>windowSize</span>
<a name="line-49"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>makeCurrent</span>
<a name="line-50"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>relativeMouseMode</span>
<a name="line-51"></a>  <span class='hs-comment'>-- * Extensible Exceptions</span>
<a name="line-52"></a>  <span class='hs-layout'>,</span> <span class='hs-conid'>SDLException</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span>
<a name="line-53"></a>  <span class='hs-comment'>-- * Utilities</span>
<a name="line-54"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>poll</span>
<a name="line-55"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>err</span>
<a name="line-56"></a>  <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-57"></a>
<a name="line-58"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>Exception</span>
<a name="line-59"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>Monad</span>
<a name="line-60"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>Monad</span><span class='hs-varop'>.</span><span class='hs-conid'>IO</span><span class='hs-varop'>.</span><span class='hs-conid'>Class</span>
<a name="line-61"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Functor</span>
<a name="line-62"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Typeable</span>
<a name="line-63"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Version</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Data</span>
<a name="line-64"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Foreign</span>
<a name="line-65"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Foreign</span><span class='hs-varop'>.</span><span class='hs-conid'>C</span>
<a name="line-66"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Quine</span><span class='hs-varop'>.</span><span class='hs-conid'>StateVar</span>
<a name="line-67"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Graphics</span><span class='hs-varop'>.</span><span class='hs-conid'>UI</span><span class='hs-varop'>.</span><span class='hs-conid'>SDL</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>SDL</span>
<a name="line-68"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>init</span><span class='hs-layout'>)</span>
<a name="line-69"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>System</span><span class='hs-varop'>.</span><span class='hs-conid'>IO</span><span class='hs-varop'>.</span><span class='hs-conid'>Unsafe</span>
<a name="line-70"></a>
<a name="line-71"></a>
<a name="line-72"></a><span class='hs-comment'>{-# LINE 70 "src/Quine/SDL.hsc" #-}</span>
<a name="line-73"></a>
<a name="line-74"></a><a name="SDLException"></a><span class='hs-comment'>-- | This is thrown in the event of an error in the @Quine.SDL@ combinators</span>
<a name="line-75"></a><a name="SDLException"></a><span class='hs-keyword'>newtype</span> <span class='hs-conid'>SDLException</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SDLException</span> <span class='hs-conid'>String</span>
<a name="line-76"></a>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span><span class='hs-layout'>)</span>
<a name="line-77"></a>
<a name="line-78"></a><a name="instance%20CInt%20-%3e%20m%20()%20err%20e%20%7c%20e%20%3c%200%20=%20liftIO%20$%20do%20msg%20%3c-%20getError%20%3e%3e=%20peekCString%20clearError%20when%20(msg%20/=%20%22%22)%20$%20throw%20$%20SDLException%20msg%20%7c%20otherwise%20=%20return%20()%20--%20%7c%20Get/Set%20relative%20mouse%20mode.%20When%20enabled%20we%20get%20relative%20mouse%20position%20events%20even%20at%20the%20screen%20edge.%20relativeMouseMode%20::%20StateVar%20Bool%20relativeMouseMode%20=%20StateVar%20getRelativeMouseMode%20(setRelativeMouseMode%20%3e=%3e%20err)%20--%20*%20Version%20--%20%7c%20Get%20the%20Version%20(and%20Revision)%20version%20::%20Data.Version%20version%20=%20unsafePerformIO%20$%20alloca%20$%20%5cp%20-%3e%20do%20getVersion%20p%20SDL.Version%20x%20y%20z%20%3c-%20peek%20p%20return%20$%20Data.Version%20(fromIntegral%20%3c$%3e%20%5bfromIntegral%20x,fromIntegral%20y,fromIntegral%20z,%20revisionNumber%5d)%20%5b%5d%20%7b-%23%20NOINLINE%20version%20%23-%7d%20revision%20::%20String%20revision%20=%20unsafePerformIO%20$%20getRevision%20%3e%3e=%20peekCString%20%7b-%23%20NOINLINE%20revision%20%23-%7d%20revisionNumber%20::%20Int%20revisionNumber%20=%20unsafePerformIO%20$%20fromIntegral%20%3c$%3e%20getRevisionNumber%20%7b-%23%20NOINLINE%20revisionNumber%20%23-%7d%20--%20*%20Attribute%20StateVars%20--%20%7c%20get%5c/set%20@SDL_GL_RED_SIZE@,%20the%20minimum%20number%20of%20bits%20for%20the%20red%20channel%20of%20the%20color%20buffer;%20defaults%20to%203%20redSize%20::%20StateVar%20Int%20redSize%20=%20attr%20SDL_GL_RED_SIZE%20--%20%7c%20get%5c/set%20@SDL_GL_GREEN_SIZE@,%20the%20minimum%20number%20of%20bits%20for%20the%20green%20channel%20of%20the%20color%20buffer;%20defaults%20to%203%20greenSize%20::%20StateVar%20Int%20greenSize%20=%20attr%20SDL_GL_GREEN_SIZE%20--%20%7c%20get%5c/set%20@SDL_GL_BLUE_SIZE@,%20the%20minimum%20number%20of%20bits%20for%20the%20blue%20channel%20of%20the%20color%20buffer;%20defaults%20to%202%20blueSize%20::%20StateVar%20Int%20blueSize%20=%20attr%20SDL_GL_BLUE_SIZE%20--%20%7c%20get%5c/set%20@SDL_GL_ALPHA_SIZE@,%20the%20minimum%20number%20of%20bits%20for%20the%20alpha%20channel%20of%20the%20color%20buffer;%20defaults%20to%200%20alphaSize%20::%20StateVar%20Int%20alphaSize%20=%20attr%20SDL_GL_ALPHA_SIZE%20--%20%7c%20get%5c/set%20@SDL_GL_BUFFER_SIZE@,%20the%20minimum%20number%20of%20bits%20for%20frame%20buffer%20size;%20defaults%20to%200%20bufferSize%20::%20StateVar%20Int%20bufferSize%20=%20attr%20SDL_GL_BUFFER_SIZE%20--%20%7c%20get%5c/set%20@SDL_GL_DEPTH_SIZE@,%20the%20minimum%20number%20of%20bits%20in%20the%20depth%20buffer;%20defaults%20to%2016%20depthSize%20::%20StateVar%20Int%20depthSize%20=%20attr%20SDL_GL_DEPTH_SIZE%20--%20%7c%20get%5c/set%20@SDL_GL_STENCIL_SIZE@,%20the%20minimum%20number%20of%20bits%20in%20the%20stencil%20buffer;%20defaults%20to%200%20stencilSize%20::%20StateVar%20Int%20stencilSize%20=%20attr%20SDL_GL_STENCIL_SIZE%20--%20%7c%20get%5c/set%20@SDL_GL_ACCUM_RED_SIZE@,%20the%20minimum%20number%20of%20bits%20for%20the%20red%20channel%20of%20the%20accumulation%20buffer;%20defaults%20to%200%20accumRedSize%20::%20StateVar%20Int%20accumRedSize%20=%20attr%20SDL_GL_ACCUM_RED_SIZE%20--%20%7c%20get%5c/set%20@SDL_GL_ACCUM_GREEN_SIZE@,%20the%20minimum%20number%20of%20bits%20for%20the%20green%20channel%20of%20the%20accumulation%20buffer;%20defaults%20to%200%20accumGreenSize%20::%20StateVar%20Int%20accumGreenSize%20=%20attr%20SDL_GL_ACCUM_GREEN_SIZE%20--%20%7c%20get%5c/set%20@SDL_GL_ACCUM_BLUE_SIZE@,%20the%20minimum%20number%20of%20bits%20for%20the%20blue%20channel%20of%20the%20accumulation%20buffer;%20defaults%20to%200%20accumBlueSize%20::%20StateVar%20Int%20accumBlueSize%20=%20attr%20SDL_GL_ACCUM_BLUE_SIZE%20--%20%7c%20get%5c/set%20@SDL_GL_ACCUM_ALPHA_SIZE@,%20the%20minimum%20number%20of%20bits%20for%20the%20alpha%20channel%20of%20the%20accumulation%20buffer;%20defaults%20to%200%20accumAlphaSize%20::%20StateVar%20Int%20accumAlphaSize%20=%20attr%20SDL_GL_ACCUM_ALPHA_SIZE%20--%20%7c%20get%5c/set%20@SDL_GL_MULTISAMPLEBUFFERS@,%20the%20number%20of%20buffers%20used%20for%20multisample%20anti-aliasing;%20defaults%20to%200;%20see%20%3chttps://wiki.libsdl.org/SDL_GLattr%23multisample%20Remarks%3e%20for%20details%20multiSampleBuffers%20::%20StateVar%20Int%20multiSampleBuffers%20=%20attr%20SDL_GL_MULTISAMPLEBUFFERS%20--%20%7c%20get%5c/set%20@SDL_GL_MULTISAMPLESAMPLES@,%20the%20number%20of%20samples%20used%20around%20the%20current%20pixel%20used%20for%20multisample%20anti-aliasing;%20defaults%20to%200;%20see%20%3chttps://wiki.libsdl.org/SDL_GLattr%23multisample%20Remarks%3e%20for%20details%20multiSampleSamples%20::%20StateVar%20Int%20multiSampleSamples%20=%20attr%20SDL_GL_MULTISAMPLESAMPLES%20--%20%7c%20get%5c/set%20@SDL_GL_CONTEXT_MAJOR_VERSION@,%20OpenGL%20context%20major%20version;%20see%20%3chttps://wiki.libsdl.org/SDL_GLattr%23OpenGL%20Remarks%3e%20for%20details%20contextMajorVersion%20::%20StateVar%20Int%20contextMajorVersion%20=%20attr%20SDL_GL_CONTEXT_MAJOR_VERSION%20--%20%7c%20get%5c/set%20@SDL_GL_CONTEXT_MINOR_VERSION@,%20OpenGL%20context%20major%20version;%20see%20%3chttps://wiki.libsdl.org/SDL_GLattr%23OpenGL%20Remarks%3e%20for%20details%20contextMinorVersion%20::%20StateVar%20Int%20contextMinorVersion%20=%20attr%20SDL_GL_CONTEXT_MINOR_VERSION%20--%20%7c%20get%5c/set%20@SDL_GL_CONTEXT_FLAGS@,%20some%20bitwise%20(.%7c.)%20of%200%20or%20more%20of:%20--%20--%20'glContextFlagDebug'%20--%20--%20This%20flag%20maps%20to%20@GLX_CONTEXT_DEBUG_BIT_ARB@%20in%20the%20@GLX_ARB_create_context@%20extension%20for%20@X11@%20and%20@WGL_CONTEXT_DEBUG_BIT_ARB@%20in%20the%20@WGL_ARB_create_context@%20extension%20for%20Windows.%20This%20flag%20is%20currently%20ignored%20on%20other%20targets%20that%20don't%20support%20equivalent%20functionality.%20This%20flag%20is%20intended%20to%20put%20the%20GL%20into%20a%20%5c%22debug%5c%22%20mode%20which%20might%20offer%20better%20developer%20insights,%20possibly%20at%20a%20loss%20of%20performance%20(although%20a%20given%20GL%20implementation%20may%20or%20may%20not%20do%20anything%20differently%20in%20the%20presence%20of%20this%20flag).%20--%20--%20'SDL_GL_CONTEXT_FORWARD_COMPATIBLE_FLAG'%20--%20--%20This%20flag%20maps%20to%20@GLX_CONTEXT_FORWARD_COMPATIBLE_BIT_ARB@%20in%20the%20@GLX_ARB_create_context@%20extension%20for%20X11%20and%20@WGL_CONTEXT_FORWARD_COMPATIBLE_BIT_ARB@%20in%20the%20@WGL_ARB_create_context@%20extension%20for%20Windows.%20This%20flag%20is%20currently%20ignored%20on%20other%20targets%20that%20don't%20support%20equivalent%20functionality.%20This%20flag%20is%20intended%20to%20put%20the%20GL%20into%20a%20%5c%22forward%20compatible%5c%22%20mode,%20which%20means%20that%20no%20deprecated%20functionality%20will%20be%20supported,%20possibly%20at%20a%20gain%20in%20performance,%20and%20only%20applies%20to%20GL%203.0%20and%20later%20contexts.%20--%20--%20'SDL_GL_CONTEXT_RESET_ISOLATION_FLAG'%20--%20--%20This%20flag%20maps%20to%20@GLX_CONTEXT_RESET_ISOLATION_BIT_ARB@%20in%20the%20@GLX_ARB_robustness_isolation@%20extension%20for%20X11%20and%20@WGL_CONTEXT_RESET_ISOLATION_BIT_ARB@%20in%20the%20@WGL_ARB_create_context_robustness@%20extension%20for%20Windows.%20This%20flag%20is%20currently%20ignored%20on%20other%20targets%20that%20don't%20support%20equivalent%20functionality.%20This%20flag%20is%20intended%20to%20require%20the%20GL%20to%20make%20promises%20about%20what%20to%20do%20in%20the%20face%20of%20driver%20or%20hardware%20failure.%20--%20--%20'SDL_GL_CONTEXT_ROBUST_ACCESS_FLAG'%20--%20--%20This%20flag%20maps%20to%20@GLX_CONTEXT_ROBUST_ACCESS_BIT_ARB@%20in%20the%20@GLX_ARB_create_context_robustness@%20extension%20for%20X11%20and%20@WGL_CONTEXT_ROBUST_ACCESS_BIT_ARB@%20in%20the%20@WGL_ARB_create_context_robustness@%20extension%20for%20Windows.%20This%20flag%20is%20currently%20ignored%20on%20other%20targets%20that%20don't%20support%20equivalent%20functionality.%20This%20flag%20is%20intended%20to%20require%20a%20GL%20context%20that%20supports%20the%20GL_ARB_robustness%20extension--a%20mode%20that%20offers%20a%20few%20APIs%20that%20are%20safer%20than%20the%20usual%20defaults%20(think%20@snprintf@()%20vs%20@sprintf@()).%20contextFlags%20::%20StateVar%20Int%20contextFlags%20=%20attr%20SDL_GL_CONTEXT_FLAGS%20--%20%7c%20get%5c/set%20@SDL_GL_CONTEXT_PROFILE_MASK@,%20which%20must%20be%20_one_%20of%20--%20--%20*%20'SDL_GL_CONTEXT_PROFILE_COMPATIBILITY'%20--%20--%20*%20'SDL_GL_CONTEXT_PROFILE_CORE'%20--%20--%20*%20'SDL_GL_CONTEXT_PROFILE_ES'%20--%20--%20Despite%20the%20name%20implying%20you%20could%20(.%7c.)%20these%20together,%20these%20are%20mutually%20exclusive!%20contextProfileMask%20::%20StateVar%20Int%20contextProfileMask%20=%20attr%20SDL_GL_CONTEXT_PROFILE_MASK%20--%20%7c%20get%5c/set%20@SDL_GL_STEREO@,%20whether%20the%20output%20is%20stereo%203D;%20defaults%20to%20off%20stereo%20::%20StateVar%20Bool%20stereo%20=%20boolAttr%20SDL_GL_STEREO%20--%20%7c%20get%5c/set%20@SDL_GL_ACCELERATED_VISUAL@,%20set%20to%20'True'%20to%20require%20hardware%20acceleration,%20set%20to%20'False'%20to%20force%20software%20rendering;%20defaults%20to%20allow%20either%20acceleratedVisual%20::%20StateVar%20Bool%20acceleratedVisual%20=%20boolAttr%20SDL_GL_ACCELERATED_VISUAL%20--%20%7c%20get%5c/set%20@SDL_GL_DOUBLEBUFFER@%20doubleBuffer%20::%20StateVar%20Bool%20doubleBuffer%20=%20boolAttr%20SDL_GL_DOUBLEBUFFER%20--%20%7c%20get%5c/set%20@SDL_GL_SHARE_WITH_CURRENT_CONTEXT@%20shareWithCurrentContext%20::%20StateVar%20Bool%20shareWithCurrentContext%20=%20boolAttr%20SDL_GL_SHARE_WITH_CURRENT_CONTEXT%20--%20%7c%20get%5c/set%20@SDL_GL_FRAMEBUFFER_SRGB_CAPABLE@%20framebufferSRGBCapable%20::%20StateVar%20Bool%20framebufferSRGBCapable%20=%20boolAttr%20SDL_GL_FRAMEBUFFER_SRGB_CAPABLE%20windowDisplayMode%20::%20Window%20-%3e%20StateVar%20DisplayMode%20windowDisplayMode%20w%20=%20StateVar%20getWDM%20setWDM"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Exception</span> <span class='hs-conid'>SDLException</span>
<a name="line-79"></a>
<a name="line-80"></a><a name="err"></a><span class='hs-comment'>-- | Treat negative return codes as prompting an error check.</span>
<a name="line-81"></a><span class='hs-definition'>err</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MonadIO</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>CInt</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>()</span>
<a name="line-82"></a><span class='hs-definition'>err</span> <span class='hs-varid'>e</span> 
<a name="line-83"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&lt;</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftIO</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<a name="line-84"></a>    <span class='hs-varid'>msg</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getError</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-varid'>peekCString</span>
<a name="line-85"></a>    <span class='hs-varid'>clearError</span>
<a name="line-86"></a>    <span class='hs-varid'>when</span> <span class='hs-layout'>(</span><span class='hs-varid'>msg</span> <span class='hs-varop'>/=</span> <span class='hs-str'>""</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>throw</span> <span class='hs-varop'>$</span> <span class='hs-conid'>SDLException</span> <span class='hs-varid'>msg</span>
<a name="line-87"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>return</span> <span class='hs-conid'>()</span>
<a name="line-88"></a>
<a name="line-89"></a><a name="relativeMouseMode"></a><span class='hs-comment'>-- | Get/Set relative mouse mode. When enabled we get relative mouse position events even at the screen edge.</span>
<a name="line-90"></a><span class='hs-definition'>relativeMouseMode</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Bool</span>
<a name="line-91"></a><span class='hs-definition'>relativeMouseMode</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>StateVar</span> <span class='hs-varid'>getRelativeMouseMode</span> <span class='hs-layout'>(</span><span class='hs-varid'>setRelativeMouseMode</span> <span class='hs-varop'>&gt;=&gt;</span> <span class='hs-varid'>err</span><span class='hs-layout'>)</span>
<a name="line-92"></a>
<a name="line-93"></a><span class='hs-comment'>-- * Version</span>
<a name="line-94"></a>
<a name="line-95"></a><a name="version"></a><span class='hs-comment'>-- | Get the Version (and Revision)</span>
<a name="line-96"></a><span class='hs-definition'>version</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Version</span>
<a name="line-97"></a><span class='hs-definition'>version</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unsafePerformIO</span> <span class='hs-varop'>$</span> <span class='hs-varid'>alloca</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>p</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-98"></a>  <span class='hs-varid'>getVersion</span> <span class='hs-varid'>p</span>
<a name="line-99"></a>  <span class='hs-conid'>SDL</span><span class='hs-varop'>.</span><span class='hs-conid'>Version</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>z</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-varid'>p</span>
<a name="line-100"></a>  <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Version</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>y</span><span class='hs-layout'>,</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>z</span><span class='hs-layout'>,</span> <span class='hs-varid'>revisionNumber</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-conid'>[]</span>
<a name="line-101"></a><span class='hs-comment'>{-# NOINLINE version #-}</span>
<a name="line-102"></a>
<a name="line-103"></a><a name="revision"></a><span class='hs-definition'>revision</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span>
<a name="line-104"></a><span class='hs-definition'>revision</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unsafePerformIO</span> <span class='hs-varop'>$</span> <span class='hs-varid'>getRevision</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-varid'>peekCString</span>
<a name="line-105"></a><span class='hs-comment'>{-# NOINLINE revision #-}</span>
<a name="line-106"></a>
<a name="line-107"></a><a name="revisionNumber"></a><span class='hs-definition'>revisionNumber</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span>
<a name="line-108"></a><span class='hs-definition'>revisionNumber</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unsafePerformIO</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getRevisionNumber</span>
<a name="line-109"></a><span class='hs-comment'>{-# NOINLINE revisionNumber #-}</span>
<a name="line-110"></a>
<a name="line-111"></a><span class='hs-comment'>-- * Attribute StateVars</span>
<a name="line-112"></a>  
<a name="line-113"></a><a name="redSize"></a><span class='hs-comment'>-- | get\/set @SDL_GL_RED_SIZE@, the minimum number of bits for the red channel of the color buffer; defaults to 3</span>
<a name="line-114"></a><span class='hs-definition'>redSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-115"></a><span class='hs-definition'>redSize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_RED_SIZE</span>
<a name="line-116"></a>
<a name="line-117"></a><a name="greenSize"></a><span class='hs-comment'>-- | get\/set @SDL_GL_GREEN_SIZE@, the minimum number of bits for the green channel of the color buffer; defaults to 3</span>
<a name="line-118"></a><span class='hs-definition'>greenSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-119"></a><span class='hs-definition'>greenSize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_GREEN_SIZE</span>
<a name="line-120"></a>
<a name="line-121"></a><a name="blueSize"></a><span class='hs-comment'>-- | get\/set @SDL_GL_BLUE_SIZE@, the minimum number of bits for the blue channel of the color buffer; defaults to 2</span>
<a name="line-122"></a><span class='hs-definition'>blueSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-123"></a><span class='hs-definition'>blueSize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_BLUE_SIZE</span>
<a name="line-124"></a>
<a name="line-125"></a><a name="alphaSize"></a><span class='hs-comment'>-- | get\/set @SDL_GL_ALPHA_SIZE@, the minimum number of bits for the alpha channel of the color buffer; defaults to 0</span>
<a name="line-126"></a><span class='hs-definition'>alphaSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-127"></a><span class='hs-definition'>alphaSize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_ALPHA_SIZE</span>
<a name="line-128"></a>
<a name="line-129"></a><a name="bufferSize"></a><span class='hs-comment'>-- | get\/set @SDL_GL_BUFFER_SIZE@, the minimum number of bits for frame buffer size; defaults to 0</span>
<a name="line-130"></a><span class='hs-definition'>bufferSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-131"></a><span class='hs-definition'>bufferSize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_BUFFER_SIZE</span>
<a name="line-132"></a>
<a name="line-133"></a><a name="depthSize"></a><span class='hs-comment'>-- | get\/set @SDL_GL_DEPTH_SIZE@, the minimum number of bits in the depth buffer; defaults to 16</span>
<a name="line-134"></a><span class='hs-definition'>depthSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-135"></a><span class='hs-definition'>depthSize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_DEPTH_SIZE</span>
<a name="line-136"></a>
<a name="line-137"></a><a name="stencilSize"></a><span class='hs-comment'>-- | get\/set @SDL_GL_STENCIL_SIZE@, the minimum number of bits in the stencil buffer; defaults to 0</span>
<a name="line-138"></a><span class='hs-definition'>stencilSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-139"></a><span class='hs-definition'>stencilSize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_STENCIL_SIZE</span>
<a name="line-140"></a>
<a name="line-141"></a><a name="accumRedSize"></a><span class='hs-comment'>-- | get\/set @SDL_GL_ACCUM_RED_SIZE@, the minimum number of bits for the red channel of the accumulation buffer; defaults to 0</span>
<a name="line-142"></a><span class='hs-definition'>accumRedSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-143"></a><span class='hs-definition'>accumRedSize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_ACCUM_RED_SIZE</span>
<a name="line-144"></a>
<a name="line-145"></a><a name="accumGreenSize"></a><span class='hs-comment'>-- | get\/set @SDL_GL_ACCUM_GREEN_SIZE@, the minimum number of bits for the green channel of the accumulation buffer; defaults to 0</span>
<a name="line-146"></a><span class='hs-definition'>accumGreenSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-147"></a><span class='hs-definition'>accumGreenSize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_ACCUM_GREEN_SIZE</span>
<a name="line-148"></a>
<a name="line-149"></a><a name="accumBlueSize"></a><span class='hs-comment'>-- | get\/set @SDL_GL_ACCUM_BLUE_SIZE@, the minimum number of bits for the blue channel of the accumulation buffer; defaults to 0</span>
<a name="line-150"></a><span class='hs-definition'>accumBlueSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-151"></a><span class='hs-definition'>accumBlueSize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_ACCUM_BLUE_SIZE</span>
<a name="line-152"></a>
<a name="line-153"></a><a name="accumAlphaSize"></a><span class='hs-comment'>-- | get\/set @SDL_GL_ACCUM_ALPHA_SIZE@, the minimum number of bits for the alpha channel of the accumulation buffer; defaults to 0</span>
<a name="line-154"></a><span class='hs-definition'>accumAlphaSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-155"></a><span class='hs-definition'>accumAlphaSize</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_ACCUM_ALPHA_SIZE</span>
<a name="line-156"></a>
<a name="line-157"></a><a name="multiSampleBuffers"></a><span class='hs-comment'>-- | get\/set @SDL_GL_MULTISAMPLEBUFFERS@, the number of buffers used for multisample anti-aliasing; defaults to 0; see &lt;https://wiki.libsdl.org/SDL_GLattr#multisample Remarks&gt; for details</span>
<a name="line-158"></a><span class='hs-definition'>multiSampleBuffers</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-159"></a><span class='hs-definition'>multiSampleBuffers</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_MULTISAMPLEBUFFERS</span>
<a name="line-160"></a>
<a name="line-161"></a><a name="multiSampleSamples"></a><span class='hs-comment'>-- | get\/set @SDL_GL_MULTISAMPLESAMPLES@, the number of samples used around the current pixel used for multisample anti-aliasing; defaults to 0; see &lt;https://wiki.libsdl.org/SDL_GLattr#multisample Remarks&gt; for details</span>
<a name="line-162"></a><span class='hs-definition'>multiSampleSamples</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-163"></a><span class='hs-definition'>multiSampleSamples</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_MULTISAMPLESAMPLES</span>
<a name="line-164"></a>
<a name="line-165"></a><a name="contextMajorVersion"></a><span class='hs-comment'>-- | get\/set @SDL_GL_CONTEXT_MAJOR_VERSION@, OpenGL context major version; see &lt;https://wiki.libsdl.org/SDL_GLattr#OpenGL Remarks&gt; for details </span>
<a name="line-166"></a><span class='hs-definition'>contextMajorVersion</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-167"></a><span class='hs-definition'>contextMajorVersion</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_CONTEXT_MAJOR_VERSION</span>
<a name="line-168"></a>
<a name="line-169"></a><a name="contextMinorVersion"></a><span class='hs-comment'>-- | get\/set @SDL_GL_CONTEXT_MINOR_VERSION@, OpenGL context major version; see &lt;https://wiki.libsdl.org/SDL_GLattr#OpenGL Remarks&gt; for details </span>
<a name="line-170"></a><span class='hs-definition'>contextMinorVersion</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-171"></a><span class='hs-definition'>contextMinorVersion</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_CONTEXT_MINOR_VERSION</span>
<a name="line-172"></a>
<a name="line-173"></a><span class='hs-comment'>-- | get\/set @SDL_GL_CONTEXT_FLAGS@, some bitwise (.|.) of 0 or more of:</span>
<a name="line-174"></a><span class='hs-comment'>--</span>
<a name="line-175"></a><span class='hs-comment'>-- 'glContextFlagDebug'</span>
<a name="line-176"></a><span class='hs-comment'>--</span>
<a name="line-177"></a><span class='hs-comment'>-- This flag maps to @GLX_CONTEXT_DEBUG_BIT_ARB@ in the @GLX_ARB_create_context@ extension for @X11@ and @WGL_CONTEXT_DEBUG_BIT_ARB@ in the @WGL_ARB_create_context@ extension for Windows. This flag is currently ignored on other targets that don't support equivalent functionality. This flag is intended to put the GL into a \"debug\" mode which might offer better developer insights, possibly at a loss of performance (although a given GL implementation may or may not do anything differently in the presence of this flag).</span>
<a name="line-178"></a><span class='hs-comment'>--</span>
<a name="line-179"></a><span class='hs-comment'>-- 'SDL_GL_CONTEXT_FORWARD_COMPATIBLE_FLAG'</span>
<a name="line-180"></a><span class='hs-comment'>--</span>
<a name="line-181"></a><span class='hs-comment'>-- This flag maps to @GLX_CONTEXT_FORWARD_COMPATIBLE_BIT_ARB@ in the @GLX_ARB_create_context@ extension for X11 and @WGL_CONTEXT_FORWARD_COMPATIBLE_BIT_ARB@ in the @WGL_ARB_create_context@ extension for Windows. This flag is currently ignored on other targets that don't support equivalent functionality. This flag is intended to put the GL into a \"forward compatible\" mode, which means that no deprecated functionality will be supported, possibly at a gain in performance, and only applies to GL 3.0 and later contexts.</span>
<a name="line-182"></a><span class='hs-comment'>--</span>
<a name="line-183"></a><span class='hs-comment'>-- 'SDL_GL_CONTEXT_RESET_ISOLATION_FLAG'</span>
<a name="line-184"></a><span class='hs-comment'>--</span>
<a name="line-185"></a><span class='hs-comment'>-- This flag maps to @GLX_CONTEXT_RESET_ISOLATION_BIT_ARB@ in the @GLX_ARB_robustness_isolation@ extension for X11 and @WGL_CONTEXT_RESET_ISOLATION_BIT_ARB@ in the @WGL_ARB_create_context_robustness@ extension for Windows. This flag is currently ignored on other targets that don't support equivalent functionality. This flag is intended to require the GL to make promises about what to do in the face of driver or hardware failure.</span>
<a name="line-186"></a><span class='hs-comment'>--</span>
<a name="line-187"></a><span class='hs-comment'>-- 'SDL_GL_CONTEXT_ROBUST_ACCESS_FLAG'</span>
<a name="line-188"></a><span class='hs-comment'>--</span>
<a name="line-189"></a><span class='hs-comment'>-- This flag maps to @GLX_CONTEXT_ROBUST_ACCESS_BIT_ARB@ in the @GLX_ARB_create_context_robustness@ extension for X11 and @WGL_CONTEXT_ROBUST_ACCESS_BIT_ARB@ in the @WGL_ARB_create_context_robustness@ extension for Windows. This flag is currently ignored on other targets that don't support equivalent functionality. This flag is intended to require a GL context that supports the GL_ARB_robustness extension--a mode that offers a few APIs that are safer than the usual defaults (think @snprintf@() vs @sprintf@()).</span>
<a name="line-190"></a>
<a name="line-191"></a><a name="contextFlags"></a><span class='hs-definition'>contextFlags</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-192"></a><span class='hs-definition'>contextFlags</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_CONTEXT_FLAGS</span>
<a name="line-193"></a>
<a name="line-194"></a><span class='hs-comment'>-- | get\/set @SDL_GL_CONTEXT_PROFILE_MASK@, which must be _one_ of</span>
<a name="line-195"></a><span class='hs-comment'>--</span>
<a name="line-196"></a><span class='hs-comment'>-- * 'SDL_GL_CONTEXT_PROFILE_COMPATIBILITY'</span>
<a name="line-197"></a><span class='hs-comment'>--</span>
<a name="line-198"></a><span class='hs-comment'>-- * 'SDL_GL_CONTEXT_PROFILE_CORE'</span>
<a name="line-199"></a><span class='hs-comment'>--</span>
<a name="line-200"></a><span class='hs-comment'>-- * 'SDL_GL_CONTEXT_PROFILE_ES'</span>
<a name="line-201"></a><span class='hs-comment'>--</span>
<a name="line-202"></a><span class='hs-comment'>-- Despite the name implying you could (.|.) these together, these are mutually exclusive!</span>
<a name="line-203"></a>
<a name="line-204"></a><a name="contextProfileMask"></a><span class='hs-definition'>contextProfileMask</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-205"></a><span class='hs-definition'>contextProfileMask</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>attr</span> <span class='hs-conid'>SDL_GL_CONTEXT_PROFILE_MASK</span>
<a name="line-206"></a>
<a name="line-207"></a><a name="stereo"></a><span class='hs-comment'>-- | get\/set @SDL_GL_STEREO@, whether the output is stereo 3D; defaults to off</span>
<a name="line-208"></a><span class='hs-definition'>stereo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Bool</span>
<a name="line-209"></a><span class='hs-definition'>stereo</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>boolAttr</span> <span class='hs-conid'>SDL_GL_STEREO</span>
<a name="line-210"></a>
<a name="line-211"></a><a name="acceleratedVisual"></a><span class='hs-comment'>-- | get\/set @SDL_GL_ACCELERATED_VISUAL@, set to 'True' to require hardware acceleration, set to 'False' to force software rendering; defaults to allow either</span>
<a name="line-212"></a><span class='hs-definition'>acceleratedVisual</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Bool</span>
<a name="line-213"></a><span class='hs-definition'>acceleratedVisual</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>boolAttr</span> <span class='hs-conid'>SDL_GL_ACCELERATED_VISUAL</span>
<a name="line-214"></a>
<a name="line-215"></a><a name="doubleBuffer"></a><span class='hs-comment'>-- | get\/set @SDL_GL_DOUBLEBUFFER@</span>
<a name="line-216"></a><span class='hs-definition'>doubleBuffer</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Bool</span>
<a name="line-217"></a><span class='hs-definition'>doubleBuffer</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>boolAttr</span> <span class='hs-conid'>SDL_GL_DOUBLEBUFFER</span>
<a name="line-218"></a>
<a name="line-219"></a><a name="shareWithCurrentContext"></a><span class='hs-comment'>-- | get\/set @SDL_GL_SHARE_WITH_CURRENT_CONTEXT@</span>
<a name="line-220"></a><span class='hs-definition'>shareWithCurrentContext</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Bool</span>
<a name="line-221"></a><span class='hs-definition'>shareWithCurrentContext</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>boolAttr</span> <span class='hs-conid'>SDL_GL_SHARE_WITH_CURRENT_CONTEXT</span>
<a name="line-222"></a>
<a name="line-223"></a><a name="framebufferSRGBCapable"></a><span class='hs-comment'>-- | get\/set @SDL_GL_FRAMEBUFFER_SRGB_CAPABLE@</span>
<a name="line-224"></a><span class='hs-definition'>framebufferSRGBCapable</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Bool</span>
<a name="line-225"></a><span class='hs-definition'>framebufferSRGBCapable</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>boolAttr</span> <span class='hs-conid'>SDL_GL_FRAMEBUFFER_SRGB_CAPABLE</span>
<a name="line-226"></a>
<a name="line-227"></a><a name="windowDisplayMode"></a><span class='hs-definition'>windowDisplayMode</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Window</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>DisplayMode</span>
<a name="line-228"></a><span class='hs-definition'>windowDisplayMode</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>StateVar</span> <span class='hs-varid'>getWDM</span> <span class='hs-varid'>setWDM</span> <span class='hs-keyword'>where</span>
<a name="line-229"></a>  <span class='hs-varid'>getWDM</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>alloca</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>p</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-230"></a>    <span class='hs-varid'>getWindowDisplayMode</span> <span class='hs-varid'>w</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-varid'>err</span>
<a name="line-231"></a>    <span class='hs-varid'>peek</span> <span class='hs-varid'>p</span> 
<a name="line-232"></a>  <span class='hs-varid'>setWDM</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>alloca</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>p</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-233"></a>    <span class='hs-varid'>poke</span> <span class='hs-varid'>p</span> <span class='hs-varid'>m</span>
<a name="line-234"></a>    <span class='hs-varid'>setWindowDisplayMode</span> <span class='hs-varid'>w</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-varid'>err</span>
<a name="line-235"></a>
<a name="line-236"></a><a name="desktopDisplayMode"></a><span class='hs-definition'>desktopDisplayMode</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>DisplayMode</span>
<a name="line-237"></a><span class='hs-definition'>desktopDisplayMode</span> <span class='hs-varid'>idx</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>alloca</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>p</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-238"></a>  <span class='hs-varid'>getDesktopDisplayMode</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>idx</span><span class='hs-layout'>)</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-varid'>err</span>
<a name="line-239"></a>  <span class='hs-varid'>peek</span> <span class='hs-varid'>p</span>
<a name="line-240"></a>
<a name="line-241"></a><a name="elemOff"></a><span class='hs-definition'>elemOff</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-conid'>Storable</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-varid'>a</span>
<a name="line-242"></a><span class='hs-definition'>elemOff</span> <span class='hs-varid'>p</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span> <span class='hs-varop'>*</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-243"></a>
<a name="line-244"></a><a name="windowSize"></a><span class='hs-definition'>windowSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Window</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StateVar</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span>
<a name="line-245"></a><span class='hs-definition'>windowSize</span> <span class='hs-varid'>win</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>StateVar</span> <span class='hs-varid'>g</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>where</span>
<a name="line-246"></a> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>allocaArray</span> <span class='hs-num'>2</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>p</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-247"></a>   <span class='hs-varid'>getWindowSize</span> <span class='hs-varid'>win</span> <span class='hs-varid'>p</span> <span class='hs-layout'>(</span><span class='hs-varid'>elemOff</span> <span class='hs-varid'>p</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<a name="line-248"></a>   <span class='hs-varid'>w</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-varid'>p</span>
<a name="line-249"></a>   <span class='hs-varid'>h</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peekElemOff</span> <span class='hs-varid'>p</span> <span class='hs-num'>1</span>
<a name="line-250"></a>   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>w</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span>
<a name="line-251"></a> <span class='hs-varid'>s</span> <span class='hs-layout'>(</span><span class='hs-varid'>w</span><span class='hs-layout'>,</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>setWindowSize</span> <span class='hs-varid'>win</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span>
<a name="line-252"></a>
<a name="line-253"></a><span class='hs-comment'>-- | Abstracts over @SDL_GL_GetSwapInterval@ / @SDL_GL_SetSwapInterval@</span>
<a name="line-254"></a><span class='hs-comment'>--</span>
<a name="line-255"></a><span class='hs-comment'>-- 0 for immediate updates, 1 for updates synchronized with the vertical retrace. -1 for late swap tearing (if supported)</span>
<a name="line-256"></a><span class='hs-comment'>-- late swap tearing support can be checked under the @GLX_EXT_swap_control_tear@ extension</span>
<a name="line-257"></a>
<a name="line-258"></a><a name="swapInterval"></a><span class='hs-definition'>swapInterval</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-259"></a><span class='hs-definition'>swapInterval</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>StateVar</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>glGetSwapInterval</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>glSetSwapInterval</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-varid'>err</span><span class='hs-layout'>)</span>
<a name="line-260"></a>
<a name="line-261"></a><span class='hs-comment'>-- * Utilities</span>
<a name="line-262"></a>
<a name="line-263"></a><a name="attr"></a><span class='hs-comment'>-- | Use a GLattr as a variable</span>
<a name="line-264"></a><span class='hs-definition'>attr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>GLattr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Int</span>
<a name="line-265"></a><span class='hs-definition'>attr</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>StateVar</span> <span class='hs-layout'>(</span><span class='hs-varid'>getAttr</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>setAttr</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-266"></a>
<a name="line-267"></a><a name="boolAttr"></a><span class='hs-definition'>boolAttr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>GLattr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Bool</span>
<a name="line-268"></a><span class='hs-definition'>boolAttr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mapStateVar</span> <span class='hs-varid'>fromEnum</span> <span class='hs-varid'>toEnum</span> <span class='hs-varop'>.</span> <span class='hs-varid'>attr</span>
<a name="line-269"></a>
<a name="line-270"></a><a name="getAttr"></a><span class='hs-definition'>getAttr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>GLattr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Int</span>
<a name="line-271"></a><span class='hs-definition'>getAttr</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>alloca</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>p</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-272"></a> <span class='hs-varid'>glGetAttribute</span> <span class='hs-varid'>a</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-varid'>err</span>
<a name="line-273"></a> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>peek</span> <span class='hs-varid'>p</span>
<a name="line-274"></a>
<a name="line-275"></a><a name="setAttr"></a><span class='hs-definition'>setAttr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>GLattr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<a name="line-276"></a><span class='hs-definition'>setAttr</span> <span class='hs-varid'>a</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>glSetAttribute</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-varid'>err</span>
<a name="line-277"></a>
<a name="line-278"></a><a name="makeCurrent"></a><span class='hs-definition'>makeCurrent</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MonadIO</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Window</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GLContext</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>()</span>
<a name="line-279"></a><span class='hs-definition'>makeCurrent</span> <span class='hs-varid'>w</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>glMakeCurrent</span> <span class='hs-varid'>w</span> <span class='hs-varid'>c</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-varid'>err</span>
<a name="line-280"></a>
<a name="line-281"></a><a name="poll"></a><span class='hs-comment'>-- | Poll events using a given handler repeatedly in a loop</span>
<a name="line-282"></a><span class='hs-definition'>poll</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MonadIO</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Event</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>()</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>()</span>
<a name="line-283"></a><span class='hs-definition'>poll</span> <span class='hs-varid'>h</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-284"></a>  <span class='hs-varid'>me</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>liftIO</span> <span class='hs-varop'>$</span> <span class='hs-varid'>alloca</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>ep</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-285"></a>    <span class='hs-varid'>r</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>pollEvent</span> <span class='hs-varid'>ep</span>
<a name="line-286"></a>    <span class='hs-keyword'>if</span> <span class='hs-varid'>r</span> <span class='hs-varop'>/=</span> <span class='hs-num'>0</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>Just</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>peek</span> <span class='hs-varid'>ep</span>
<a name="line-287"></a>              <span class='hs-keyword'>else</span> <span class='hs-varid'>return</span> <span class='hs-conid'>Nothing</span>
<a name="line-288"></a>  <span class='hs-keyword'>case</span> <span class='hs-varid'>me</span> <span class='hs-keyword'>of</span>
<a name="line-289"></a>    <span class='hs-conid'>Just</span> <span class='hs-varid'>e</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>h</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>poll</span> <span class='hs-varid'>h</span>
<a name="line-290"></a>    <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>()</span>
</pre></body>
</html>
